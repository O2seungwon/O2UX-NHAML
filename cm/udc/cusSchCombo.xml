<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_screenName="FromToCalendar UDC" meta_desc="FromToCalendar UDC\n시작일부터 마감일까지의 날짜를 지정할 수 있으며, 선택한 기간을 일반일자, 영업일자 2가지로 보여줄 수 있다." meta_memo="" meta_author="Max" meta_date="2024.11.06">
        <w2:type palette="support">COMPONENT</w2:type>
        <w2:buildDate/>
        <w2:MSA/>
        <xf:model>
            <w2:dataCollection baseNode="map">
            	<w2:aliasDataMap scope="" id="adm_dataMap"></w2:aliasDataMap>
            </w2:dataCollection>
            <w2:workflowCollection/>
        </xf:model>
        <w2:layoutInfo/>
        <w2:publicInfo method="scwin.focus,scwin.setCmbDscBySchNo,scwin.isValidRlno,scwin.getReadOnly,scwin.setReadOnly,scwin.hide,scwin.show,scwin.getCmbDsc,scwin.ㅎㄷㅅ쳐누ㅐ"/>
        <script lazy="false" type="text/javascript"><![CDATA[
/**
 * @component
 * @componentName udc_fromToCalendar
 * @pluginName 
 * @company Inswave
 * @developer Max
 * @category /cm/udc
 * @notSupportBrowser 
 * @version
 * @htmlRender
 * @icon
 * @disableIcon
 * @description
 * @width
 * @height
 * @license
 * @imagePath
 * @homepage
 */

/**
 * @property
 * @name id
 * @category 01.Basic & ETC
 * @type string
 * @option
 * @default
 * @necessary N
 * @bindparent
 * @description udc의 id값을 설정한다.
 */

/**
 * @property
 * @name class
 * @category 01.Basic & ETC
 * @type string
 * @option
 * @default
 * @necessary N
 * @bindparent
 * @description udc의 CSS Class를 지정한다.
 */

/**
 * @property
 * @name style
 * @category 01.Basic & ETC
 * @type string
 * @option
 * @default
 * @necessary N
 * @bindparent
 * @description style을 지정한다.
 */

/**
 * @property
 * @name refGbn
 * @category 01.Basic & ETC
 * @type bindColumn
 * @option
 * @default
 * @necessary N
 * @bindparent
 * @description 고객번호 종류 dataMap과 컴포넌트를 바인딩할 때 사용. 
 *  "data:" prefix를 추가하여 data:[DataMap ID].[Key id] 형태로 지정해야 함. 
 * 예) data:dataMap1.dept
 */

/**
 * @property
 * @name ref
 * @category 01.Basic & ETC
 * @type bindColumn
 * @option
 * @default
 * @necessary N
 * @bindparent
 * @description 고객번호 dataMap과 컴포넌트를 바인딩할 때 사용. 
 *  "data:" prefix를 추가하여 data:[DataMap ID].[Key id] 형태로 지정해야 함. 
 * 예) data:dataMap1.dept
 */

/**
 * @property
 * @name readOnly
 * @category 01.Basic & ETC
 * @type combobox
 * @option [true,false]
 * @default
 * @necessary N
 * @bindparent
 * @description HTML의 readOnly
 */





// 전역변수

scwin.onpageload = function () { 

    scwin.option = $p.getOptions();
    let dataMap = "";

    // 속성 refGbn 확인
    if (!$c.util.isEmpty(scwin.option.refGbn)) {
        const dataObj = scwin.option.refGbn.replaceAll("data:", "").split(".");

        if ($c.util.isEmpty(dataMap)) {
            dataMap = dataObj[0];
            adm_dataMap.setScope(`../${dataMap}`);
        }

        cmb_schGbn.setRef(`data:adm_dataMap.${dataObj[1]}`);
    }

    // 속성 ref 확인
    if (!$c.util.isEmpty(scwin.option.ref)) {
        const dataObj = scwin.option.ref.replaceAll("data:", "").split(".");

        if ($c.util.isEmpty(dataMap)) {
            dataMap = dataObj[0];
            adm_dataMap.setScope(`../${dataMap}`);
        }

        ipt_schNo.setRef(`data:adm_dataMap.${dataObj[1]}`);
    }

    // 속성 readOnly 확인
    if (!$c.util.isEmpty(scwin.option.readOnly)) {
        ipt_schNo.setReadOnly(scwin.option.readOnly);
        cmb_schGbn.setDisabled(scwin.option.readOnly);
    }
    
    // oninput으로 상시 입력 값 체크를 하는 경우 아래의 주석 해제하여 함수 구현
    // ipt_start.bind('oninput', scwin.oninput_ipt_calendar);
    // ipt_exit.bind('oninput', scwin.oninput_ipt_calendar);
};

/**
 * @method
 * @name focus
 * @description 웹스퀘어 컴포넌트에 포커스를 줌
 * @param
 * @returns
 * @hidden N
 * @exception
 * @example
 */
scwin.focus = function () {
	ipt_schNo.focus();
};

/**
 * @method
 * @name setCmbDscBySchNo
 * @description 입력값을 확인하여 조회구분 콤보 세트
 * @param {string} value desc
 * @returns
 * @hidden N
 * @exception
 * @example
 */
scwin.setCmbDscBySchNo = function (value) {
    let schno = $c.str.replaceAll($c.str.trim(value), "-", "");
    if ($c.util.isEmpty(schno)) return;
    
	if( schno.length == 10 ) { //10자리 : 고객번호 or 사업자번호
		//맨 앞자리가 1이고, 가운데가 81~88인 경우 법인사업자로 인식하여 사업자번호 세트.(나머지는 고객번호 세트)
		if( schno.substring(0, 1) == "1" && schno.substring(3,5) >= "81" && schno.substring(3,5) <= "88" ) { //사업번호
			cmb_schGbn.setValue("2");   //사업자번호
        } else {
			cmb_schGbn.setValue("3");   //고객번호
		}
	
    } else if(schno.length == 13 ) {  //13자리 : 실명번호 or 계좌번호
	
		if( scwin.isValidRlno(schno) ) {
			cmb_schGbn.setValue("1"); //실명번호
        } else {
			cmb_schGbn.setValue("4"); //계좌번호
		}
	
    } else if( schno.length > 10 ) {    // 그외는 계좌번호
		cmb_schGbn.setValue("4"); //계좌번호
	}

    ipt_schNo.setDisplayFormatter("scwin.displayFormat");
};


/**
 * @method
 * @name isValidRlno
 * @description 실명번호 여부
 * @param {string} value desc
 * @returns
 * @hidden N
 * @exception
 * @example
 */
scwin.isValidRlno = function(value) {
	const rlnostr = /^[0-9]{2}(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|[3][0-1])-[1-6][0-9]{6}$/;
	const lRlnoMask = $c.str.formatRlnoMasked(value);
	if (rlnostr.test(lRlnoMask)) return true;
	return false;
};

/**
 * @method
 * @name getReadOnly
 * @description 현재 웹스퀘어 컴포넌트에 설정된 readOnly 속성 값을 반환.
 * @param
 * @returns {Boolean} 현재 설정되어 있는 readOnly 속성
 * @hidden N
 * @exception
 * @example
 */
scwin.getReadOnly = function () {
	return ipt_schNo.getReadOnly();
};

/**
 * @method
 * @name setReadOnly
 * @description 웹스퀘어 컴포넌트의 readOnly 속성을 설정. 
 * @param {Boolean} readOnly readOnly 속성 활성화 여부(true:활성화 , false:비활성화)
 * @returns
 * @hidden N
 * @exception
 * @example
 */
scwin.setReadOnly = function (readOnly) {
	cmb_schGbn.setReadOnly(readOnly);
    ipt_schNo.setReadOnly(readOnly);
};

/**
 * @method
 * @name hide
 * @description 컴포넌트를 화면에서 보이지 않도록 숨김.
 * @param
 * @returns
 * @hidden N
 * @exception
 * @example
 */
scwin.hide = function () {
	grp_wrap.hide("");
};

/**
 * @method
 * @name show
 * @description 웹스퀘어 컴포넌트를 화면에 표시
 * @param 
 * @returns
 * @hidden N
 * @exception
 * @example
 */
scwin.show = function () {
	grp_wrap.show("");
};

/**
 * @method
 * @name getCmbDsc
 * @description selectBox의 value
 * @param 
 * @returns {String} selectBox의 value
 * @hidden N
 * @exception
 * @example
 */
scwin.getValueCmb = function () {
	return cmb_schGbn.getValue();;
};

/**
 * @method
 * @name getValue
 * @description inputBox value
 * @param 
 * @returns {String} inputBox의 value
 * @hidden N
 * @exception
 * @example
 */
scwin.getValue = function () {
	return ipt_schNo.getValue();
};

/**
 * @event
 * @name ipt_schNo_onchange
 * @description input영역의 포커스를 잃었을 때 발생
 */
scwin.ipt_schNo_onchange = function (info) {
   //구분값이 있으면 변경x 
   // if ( !$c.util.isEmpty(cmb_schGbn.getValue()) && length(gBfStr_cusSchCombo) == length(schno) ) {
	if (!$c.util.isEmpty(cmb_schGbn.getValue()) && info.oldValue.replaceAll("-","").length == info.newValue.replaceAll("-","").length) return;
     
    scwin.setCmbDscBySchNo(info.newValue);

};

/**
 * @method
 * @name displayFormat
 * @description displayformat
 * @param
 * @returns
 * @hidden N
 * @exception
 * @example
 */
scwin.displayFormat = function(value) {
    value = value.replaceAll("-", "");
    const gbn = cmb_schGbn.getValue();
    let rtnVal = value;

    if (gbn == "1" || gbn == "2") {    //실명번호 or 사업자번호
        rtnVal = $c.str.formatRlnoMasked(value);
    } else if (gbn == "4") {    //계좌번호
        rtnVal = $c.str.formatAcno(value);
    }

    return rtnVal;
};

/**
 * @event
 * @name cmb_schGbn_onchange
 * @description select가 변경되었을 때
 */
scwin.cmb_schGbn_onchange = function (info) {
    ipt_schNo.setDisplayFormatter("scwin.displayFormat");
};
]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload">
    	<xf:group class="wrap_period" id="grp_wrap" style="">
    		<xf:select1 allOption="" appearance="minimal" chooseOption="true" chooseOptionLabel="" class="fl" delimiter="-" direction="auto"
    			disabled="false" disabledClass="w2selectbox_disabled" id="cmb_schGbn" ref="" style="width: 150px;margin-right: 5px;"
    			submenuSize="auto" ev:onchange="scwin.cmb_schGbn_onchange">
    			<xf:choices>
    				<xf:item>
    					<xf:label><![CDATA[[1] 실명번호]]></xf:label>
    					<xf:value><![CDATA[1]]></xf:value>
    				</xf:item>
    				<xf:item>
    					<xf:label><![CDATA[[2] 사업자번호]]></xf:label>
    					<xf:value><![CDATA[2]]></xf:value>
    				</xf:item>
    				<xf:item>
    					<xf:label><![CDATA[[3] 고객번호]]></xf:label>
    					<xf:value><![CDATA[3]]></xf:value>
    				</xf:item>
    				<xf:item>
    					<xf:label><![CDATA[[4] 계좌번호]]></xf:label>
    					<xf:value><![CDATA[4]]></xf:value>
    				</xf:item>
    			</xf:choices>
    		</xf:select1>
    		<xf:input adjustMaxLength="false" class="" id="ipt_schNo" ref="data:dma_popupParam01.param01" style="width: 200px;height:30px;" allowChar="0-9-" displayFormatter="scwin.displayFormat" ev:onchange="scwin.ipt_schNo_onchange"></xf:input>
    		</xf:group>
    	
    </body>
</html>
